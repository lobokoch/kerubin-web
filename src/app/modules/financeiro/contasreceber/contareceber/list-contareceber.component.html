<!--
**********************************************************************************************
Code generated by MKL Plug-in
Copyright: Kerubin - kerubin.platform@gmail.com

WARNING: DO NOT CHANGE THIS CODE BECAUSE THE CHANGES WILL BE LOST IN THE NEXT CODE GENERATION.
***********************************************************************************************
-->

<div class="container">
	<p-panel>
		<p-header>
			<div class="kb-form-panel-header">{{ getTranslation('financeiro.contas_receber.contaReceber') }}</div>
		</p-header>
	

  	<div class="ui-g">
		
		<!-- Begin Filters -->
		<p-accordion class="ui-g-12">
			<p-accordionTab header="Filtros">
			
				<div class="ui-g">
					<div class="ui-g-12">
						
						<div class="ui-g-12 ui-md-12 ui-fluid">
							<label class="label-r">Contas</label>
							<p-autoComplete name="contaReceberDescricaoAutoComplete" 
							placeholder="Digite para pesquisar..." [dropdown]="true" 
							[(ngModel)]="contaReceberListFilter.descricao" [multiple]="true"
							[suggestions]="contaReceberDescricaoAutoCompleteSuggestions"
							(completeMethod)="contaReceberDescricaoAutoComplete($event)"
							field="descricao"></p-autoComplete>
						</div>
						
						
						<div class="ui-g-12 ui-md-12 ui-fluid">
						
						    <div class="ui-g-12 ui-md-2 ui-fluid">
						        <label style="display: block">Intervalo de tempo</label>
						        <p-dropdown #contaReceberDataVencimentoIsBetweenOptions 
							        [options]="dateFilterIntervalDropdownItems" 
							        [(ngModel)]="contaReceberDataVencimentoIsBetweenOptionsSelected"
							        optionLabel="label" (click)="contaReceberDataVencimentoIsBetweenOptionsOnClick(contaReceberDataVencimentoIsBetweenOptions)">
						        </p-dropdown>
						    </div>
						
						    <div class="ui-g-12 ui-md-2 ui-fluid">
						      	<label class="label-r">Vencimento de</label>
						        <p-calendar name="dataVencimentoFrom"
						        dateFormat="dd/mm/yy" [(ngModel)]="contaReceberListFilter.dataVencimentoFrom"></p-calendar>
						    </div>
						
						    <div class="ui-g-12 ui-md-2 ui-fluid">
						        <label class="label-l label-r">Até</label>
						        <p-calendar name="dataVencimentoTo" dateFormat="dd/mm/yy"
						        [(ngModel)]="contaReceberListFilter.dataVencimentoTo"></p-calendar>
						    </div>
						    
						</div>
						
						
						
						<div class="ui-g-12 ui-md-12 ui-fluid">
						
						    <div class="ui-g-12 ui-md-3 ui-fluid">
						      	<label class="label-r">Contas com valores de</label>
						        <input pInputText type="text" name="valorFrom"
						        currencyMask [options]="{prefix: '', thousands: '.', decimal: ',', allowNegative: false}" placeholder="0,00"
						        [(ngModel)]="contaReceberListFilter.valorFrom" />
						    </div>
						
						    <div class="ui-g-12 ui-md-3 ui-fluid">
						        <label class="label-l label-r">até</label>
						        <input pInputText type="text" name="valorTo"
						        currencyMask [options]="{prefix: '', thousands: '.', decimal: ',', allowNegative: false}" placeholder="0,00"
						        [(ngModel)]="contaReceberListFilter.valorTo" />
						    </div>
						    
						</div>
						
						
						<div class="ui-g-12 ui-md-12 ui-fluid">
							<label class="label-r">Forma de pagamento</label>
							<p-dropdown [options]="contaReceberFormaPagamentoOptions" placeholder="Selecione um item..."
							[(ngModel)]="contaReceberListFilter.formaPagamento"></p-dropdown>
						</div>
						
						
						<div class="ui-g-12 ui-md-4 ui-fluid">
							<label style="display: block" class="label-l label-r">Recebidas</label>
							<p-inputSwitch [(ngModel)]="contaReceberListFilter.dataPagamentoIsNotNull"></p-inputSwitch>
						</div>
						
						
						<div class="ui-g-12 ui-md-4 ui-fluid">
							<label style="display: block" class="label-l label-r">Em aberto</label>
							<p-inputSwitch [(ngModel)]="contaReceberListFilter.dataPagamentoIsNull"></p-inputSwitch>
						</div>
						
						
						
						<div class="ui-g-12 ui-md-4 ui-fluid">
							<label style="display: block" class="label-l label-r">Baixa via conc. banc.</label>
							<p-inputSwitch [(ngModel)]="contaReceberListFilter.idConcBancariaIsNotNull"></p-inputSwitch>
						</div>
						
						
						
						<div class="ui-g-12 ui-md-6 ui-fluid">
							<label class="label-r">Histórico da conciliação bancária</label>
							<p-autoComplete name="contaReceberHistConcBancariaAutoComplete" 
							placeholder="Digite para pesquisar..." [dropdown]="true" 
							[(ngModel)]="contaReceberListFilter.histConcBancaria" [multiple]="true"
							[suggestions]="contaReceberHistConcBancariaAutoCompleteSuggestions"
							(completeMethod)="contaReceberHistConcBancariaAutoComplete($event)"
							field="histConcBancaria"></p-autoComplete>
						</div>
						
						<div class="ui-g-12 ui-md-12 ui-fluid">
							<label class="label-r">Agrupador:</label>
							<p-autoComplete name="contaReceberAgrupadorAutoComplete" 
							placeholder="Digite para pesquisar..." [dropdown]="true" 
							[(ngModel)]="contaReceberListFilter.agrupador" [multiple]="true"
							[suggestions]="contaReceberAgrupadorAutoCompleteSuggestions"
							(completeMethod)="contaReceberAgrupadorAutoComplete($event)"
							field="agrupador"></p-autoComplete>
						</div>
					</div>
					
					<div>
						<p-button label="Aplicar os filtros e pesquisar" icon="pi pi-search" iconPos="left" (click)="contaReceberFilterSearch()"></p-button>
					</div>
				</div>
				
			
			</p-accordionTab>
		</p-accordion>
		<!-- End Filters -->
		
		<!-- Begin buttons -->
		<div class="ui-g-12 crud-buttons-top kb-mobile-only">
		  <div class="ui-g-12 ui-md-2 ui-fluid">
		    <a routerLink="/contareceber/novo" pButton  label="Novo" tooltipPosition="top" pTooltip="Criar novo registro de conta a receber."></a>
		  </div>
		</div>
		<!-- End buttons -->
		
		
		<!-- Begin GRID -->
		<div class="ui-g-12" name="data-grid">
			<p-table styleClass="kb-grid kb-grid-contareceber" selectionMode="single" [loading]="tableLoading"
				[showCurrentPageReport]="true" [rowsPerPageOptions]="[5,10,50,100]"
				currentPageReportTemplate="Mostrando {first} até {last} de {totalRecords} registros."
				[responsive]="true" sortMode="multiple" [paginator]="true" [resizableColumns]="true"
				[value]="contaReceberListItems"
			    [rows]="contaReceberListFilter.pageSize" 
			    [totalRecords]="contaReceberListTotalElements"
			    [lazy]="true" (onLazyLoad)="contaReceberListOnLazyLoad($event)" >
			    <ng-template pTemplate="header">
		            <tr>
		            	<th [pSortableColumn]="'descricao'">{{ getTranslation('financeiro.contas_receber.contaReceber_descricao_grid') }}<p-sortIcon [field]="'descricao'"></p-sortIcon></th>
		            	<th style="width: 7em;" [pSortableColumn]="'dataVencimento'">{{ getTranslation('financeiro.contas_receber.contaReceber_dataVencimento_grid') }}<p-sortIcon [field]="'dataVencimento'"></p-sortIcon></th>
		            	<th style="width: 8em; text-align: right;" [pSortableColumn]="'valor'">{{ getTranslation('financeiro.contas_receber.contaReceber_valor_grid') }}<p-sortIcon [field]="'valor'"></p-sortIcon></th>
		            	<th style="text-align: center;" >{{ getTranslation('financeiro.contas_receber.contaReceber_situacaoConta_grid') }}</th>
		            	<th [pSortableColumn]="'formaPagamento'">{{ getTranslation('financeiro.contas_receber.contaReceber_formaPagamento_grid') }}<p-sortIcon [field]="'formaPagamento'"></p-sortIcon></th>
		            	<th [pSortableColumn]="'cliente'">{{ getTranslation('financeiro.contas_receber.contaReceber_cliente_grid') }}<p-sortIcon [field]="'cliente'"></p-sortIcon></th>
		            	<th style="width: 7em;" [pSortableColumn]="'dataPagamento'">{{ getTranslation('financeiro.contas_receber.contaReceber_dataPagamento_grid') }}<p-sortIcon [field]="'dataPagamento'"></p-sortIcon></th>
		            	<th style="width: 8em; text-align: right;" [pSortableColumn]="'valorPago'">{{ getTranslation('financeiro.contas_receber.contaReceber_valorPago_grid') }}<p-sortIcon [field]="'valorPago'"></p-sortIcon></th>
						<th style="width: 14em">Ações</th>
		            </tr>
		        </ng-template>
		        
			    <ng-template pTemplate="body" let-contaReceber>
		            <tr [pSelectableRow]="contaReceber">
		            	<td>
		            		<span class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_descricao_grid') }}:</span>
		            		{{ contaReceber?.descricao }}
		            	</td>
		            	<td>
		            		<span class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_dataVencimento_grid') }}:</span>
		            		{{contaReceber?.dataVencimento | date:'dd/MM/yyyy' }}
		            	</td>
		            	<td class="kb-field-money">
		            		<span class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_valor_grid') }}:</span>
		            		{{contaReceber?.valor | currency:'BRL':'symbol':'1.2-2':'pt' }}
		            	</td>
		            	<td>
		            		<span style="float: left !important;" class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_situacaoConta_grid') }}:</span>
		            		<div [ngClass]="applyRuleGridColumnsStyleClass_SituacaoConta(contaReceber)">
		            		{{applyRuleAddColumnSituacaoContaGetValue(contaReceber)}}
		            		</div>
		            	</td>
		            	<td>
		            		<span class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_formaPagamento_grid') }}:</span>
		            		{{ getTranslation('financeiro.contas_receber.contaReceber_formaPagamento' + '_' + contaReceber?.formaPagamento?.toLowerCase()) }}
		            	</td>
		            	<td>
		            		<span class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_cliente_grid') }}:</span>
		            		{{contaReceberClienteAutoCompleteFieldConverter(contaReceber?.cliente)}}
		            	</td>
		            	<td>
		            		<span class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_dataPagamento_grid') }}:</span>
		            		{{contaReceber?.dataPagamento | date:'dd/MM/yyyy' }}
		            	</td>
		            	<td class="kb-field-money">
		            		<span class="ui-column-title">{{ getTranslation('financeiro.contas_receber.contaReceber_valorPago_grid') }}:</span>
		            		{{contaReceber?.valorPago | currency:'BRL':'symbol':'1.2-2':'pt' }}
		            	</td>
		              	<td class="kb-actions">
		              		<a pButton [routerLink]="['/contareceber', contaReceber.id]" icon="pi pi-pencil" pTooltip="Editar" tooltipPosition="top"></a>
		              		<button (click)="deleteContaReceber(contaReceber)" pButton icon="pi pi-trash"  pTooltip="Excluir" tooltipPosition="top"></button>
		              		<button pButton
		              		    [disabled]="!actionBaixarContaComDataPagamentoHojeWhen(contaReceber)"
		              		    (click)="actionBaixarContaComDataPagamentoHoje(contaReceber)"
		              		    icon="pi pi-clock"  tooltipPosition="top"
		              		    pTooltip="Baixar a conta com a data de pagamento igual a data de hoje">
		              		</button>
		              		<button pButton
		              		    [disabled]="!actionBaixarContaComDataPagamentoIgualDataVencientoWhen(contaReceber)"
		              		    (click)="actionBaixarContaComDataPagamentoIgualDataVenciento(contaReceber)"
		              		    icon="pi pi-calendar"  tooltipPosition="top"
		              		    pTooltip="Baixar a conta com a data de pagamento igual a data de vencimento">
		              		</button>
		              		<button pButton
		              		    [disabled]="!actionEstornarRecebimentoContaComUmCliqueWhen(contaReceber)"
		              		    (click)="actionEstornarRecebimentoContaComUmClique(contaReceber)"
		              		    icon="pi pi-arrow-up"  tooltipPosition="left"
		              		    pTooltip="Estornar o recebimento da conta">
		              		</button>
		              	</td>
		            </tr>
		        </ng-template>
		        
		        
		        <ng-template pTemplate="emptymessage" let-columns>
				    <tr>
				        <td [attr.colspan]="9">
				            Nenhum registro encontrado.
				        </td>
				    </tr>
				</ng-template>
				
				<ng-template pTemplate="footer">
					<tr>
						<td class="kb-sum-footer">Totais</td>
						<td class="kb-sum-footer"></td>
						<td class="kb-sum-footer sumField kb-conta-valor-apagar">(A): {{ contaReceberSumFields.sumValor | currency:'BRL':'symbol':'1.2-2':'pt' }}</td>
						<td class="kb-sum-footer"></td>
						<td class="kb-sum-footer"></td>
						<td class="kb-sum-footer"></td>
						<td class="kb-sum-footer"></td>
						<td class="kb-sum-footer sumField kb-conta-valor-pago">(B): {{ contaReceberSumFields.sumValorPago | currency:'BRL':'symbol':'1.2-2':'pt' }}</td>
						<td class="kb-sum-footer">(<span class="kb-conta-valor-apagar">A</span>-<span class="kb-conta-valor-pago">B</span>): {{ (contaReceberSumFields.sumValor - contaReceberSumFields.sumValorPago) | currency:'BRL':'symbol':'1.2-2':'pt' }}</td>
					</tr>
				</ng-template>
				
				<ng-template pTemplate="summary">
					<div class="kb-mobile-block"><span class=" kb-conta-valor-apagar">Soma "Valor total" (A): {{ contaReceberSumFields.sumValor | currency:'BRL':'symbol':'1.2-2':'pt' }}</span></div>
					<div class="kb-mobile-block"><span class=" kb-conta-valor-pago">Soma "Valor total recebido" (B): {{ contaReceberSumFields.sumValorPago | currency:'BRL':'symbol':'1.2-2':'pt' }}</span></div>
					<div>Sumarização (<span class="kb-conta-valor-apagar">A</span>-<span class="kb-conta-valor-pago">B</span>): {{ (contaReceberSumFields.sumValor - contaReceberSumFields.sumValorPago) | currency:'BRL':'symbol':'1.2-2':'pt' }}</div>
				</ng-template>
			</p-table>
		</div>
		<!-- End GRID -->
		
		<!-- Begin buttons -->
		<div class="ui-g-12 crud-buttons-bottom">
		  <div class="ui-g-12 ui-md-2 ui-fluid">
		    <a routerLink="/contareceber/novo" pButton  label="Novo" tooltipPosition="top" pTooltip="Criar novo registro de conta a receber."></a>
		  </div>
		</div>
		<!-- End buttons -->
		
	</div>
	
	</p-panel>
  
</div>
